<%# Settings Page - Using Shopify App Bridge Forms with Save Bar %>

<s-page heading="Settings">
  <s-link slot="breadcrumb-actions" href="<%= root_path(host: @host) %>">Dashboard</s-link>
</s-page>

<form 
  action="<%= settings_path(host: @host) %>" 
  method="post" 
  data-save-bar
  data-discard-confirmation
  id="settings-form"
>
  <input type="hidden" name="_method" value="patch" />
  <input type="hidden" name="authenticity_token" value="<%= form_authenticity_token %>" />
  
  <!-- Alert Settings -->
  <div class="stat-card" style="margin-bottom: 24px;">
    <h3 style="font-size: 16px; margin: 0 0 24px 0;">Alert Preferences</h3>
    
    <div style="margin-bottom: 20px;">
      <label style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer;">
        <input 
          type="checkbox" 
          name="shop_setting[email_alerts_enabled]" 
          value="1"
          <%= @settings.email_alerts_enabled ? 'checked' : '' %>
          style="width: 18px; height: 18px; margin-top: 2px;"
        />
        <input type="hidden" name="shop_setting[email_alerts_enabled]" value="0" />
        <div>
          <p style="margin: 0; font-weight: 500;">Email alerts</p>
          <p style="margin: 4px 0 0 0; font-size: 13px; color: #6d7175;">
            Receive email notifications when high-severity issues are detected
          </p>
        </div>
      </label>
    </div>
    
    <div style="margin-bottom: 20px;">
      <label style="display: flex; align-items: flex-start; gap: 12px; cursor: pointer;">
        <input 
          type="checkbox" 
          name="shop_setting[admin_alerts_enabled]" 
          value="1"
          <%= @settings.admin_alerts_enabled ? 'checked' : '' %>
          style="width: 18px; height: 18px; margin-top: 2px;"
        />
        <input type="hidden" name="shop_setting[admin_alerts_enabled]" value="0" />
        <div>
          <p style="margin: 0; font-weight: 500;">Shopify admin notifications</p>
          <p style="margin: 4px 0 0 0; font-size: 13px; color: #6d7175;">
            Receive notifications in your Shopify admin dashboard
          </p>
        </div>
      </label>
    </div>
    
    <div>
      <label for="alert_email" style="display: block; margin-bottom: 8px; font-weight: 500;">
        Alert email address
      </label>
      <input 
        type="email"
        id="alert_email"
        name="shop_setting[alert_email]"
        placeholder="<%= @shop.email || @shop.shopify_domain %>"
        value="<%= @settings.alert_email %>"
        style="width: 100%; max-width: 400px; padding: 10px 12px; border: 1px solid #c9cccf; border-radius: 8px; font-size: 14px;"
      />
      <p style="margin: 8px 0 0 0; font-size: 13px; color: #6d7175;">
        <% if @shop.email.present? %>
          Leave blank to use your shop's email (<%= @shop.email %>)
        <% else %>
          Leave blank to use your store's default email
        <% end %>
      </p>
    </div>
  </div>
  
  <!-- Scan Settings -->
  <div class="stat-card" style="margin-bottom: 24px;">
    <h3 style="font-size: 16px; margin: 0 0 24px 0;">Scan Settings</h3>
    
    <div>
      <label for="scan_frequency" style="display: block; margin-bottom: 8px; font-weight: 500;">
        Scan frequency
      </label>
      <select 
        id="scan_frequency"
        name="shop_setting[scan_frequency]"
        style="padding: 10px 12px; border: 1px solid #c9cccf; border-radius: 8px; font-size: 14px; min-width: 200px;"
      >
        <option value="daily" <%= @settings.scan_frequency == 'daily' ? 'selected' : '' %>>Daily (recommended)</option>
        <option value="weekly" <%= @settings.scan_frequency == 'weekly' ? 'selected' : '' %>>Weekly</option>
      </select>
      <p style="margin: 8px 0 0 0; font-size: 13px; color: #6d7175;">
        How often to automatically scan your monitored pages
      </p>
    </div>
  </div>
  
</form>

